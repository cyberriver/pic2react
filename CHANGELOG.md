# Changelog

Все значимые изменения в проекте React Component Generator будут документированы в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [0.1.0] - 2025-09-21

### Добавлено
- **Основная функциональность**
  - Автоматическая генерация React компонентов из изображений UI элементов
  - Поддержка анализа изображений через OpenRouter API (Claude 3.5 Sonnet)
  - Интеграция с OpenAI Vision API как альтернатива
  - Поддержка React 18 с TypeScript
  - Веб-интерфейс на React 18 с Material-UI
  - Real-time мониторинг через Socket.io

- **Архитектура системы**
  - Модульная архитектура с разделением на core модули
  - FileWatcher для автоматической обработки изображений
  - VisionAnalyzer для анализа UI элементов
  - ProjectAnalyzer для определения зависимостей React проектов
  - CodeGenerator с Handlebars шаблонами
  - MockGenerator для генерации тестовых данных

- **Поддерживаемые форматы**
  - Изображения: PNG, JPG, JPEG, WEBP
  - React версии: 18.x
  - TypeScript поддержка
  - CSS модули и styled-components

- **Веб-интерфейс**
  - Dashboard с статистикой системы
  - Drag & Drop загрузка изображений
  - Предпросмотр сгенерированных компонентов
  - Мониторинг очереди обработки
  - Настройки системы

- **API эндпоинты**
  - `GET /api/health` - проверка состояния системы
  - `POST /api/images/upload` - загрузка изображений
  - `GET /api/projects` - список React проектов
  - `GET /api/images/status/:id` - статус обработки

### Изменено
- **Конфигурация**
  - Обновлена версия с v1.0.0 на v0.1.0
  - Добавлена поддержка OpenRouter API для регионов с ограничениями
  - Настроены правильные порты: Backend (3001), Frontend (3000)

- **Обработка данных**
  - Исправлена структура данных от Vision API
  - Добавлена санитизация данных для Handlebars шаблонов
  - Улучшена обработка bbox координат

### Исправлено
- **Backend ошибки**
  - Исправлен синтаксис импорта JSON в Node.js ESM модулях
  - Добавлена зависимость `glob` для поиска файлов
  - Исправлен метод `setupSocketIO` → `setupSocketHandlers`
  - Добавлена обработка ошибок портов (EADDRINUSE)

- **Frontend ошибки**
  - Исправлен синтаксис `useQuery` для React Query v5
  - Добавлены недостающие зависимости: `react-dropzone`, `@tanstack/react-query`
  - Исправлены дублирующиеся зависимости в package.json

- **Обработка файлов**
  - Исправлено сохранение файлов с расширениями через multer
  - Добавлена валидация типов файлов
  - Улучшена обработка ошибок загрузки

### Технические детали
- **Зависимости**
  - Backend: Express.js, Socket.io, Multer, Winston, Handlebars
  - Frontend: React 18, Material-UI, React Query, React Router
  - AI: OpenRouter API, OpenAI Vision API
  - Утилиты: Sharp, Prettier, Chokidar

- **Структура проекта**
  ```
  pic2react/
  ├── src/                    # Backend сервер
  ├── core/                   # Основные модули
  ├── templates/              # Handlebars шаблоны
  ├── web-ui/                 # React frontend
  ├── config/                 # Конфигурационные файлы
  ├── incoming/               # Папка для загрузки изображений
  ├── output/                 # Сгенерированные компоненты
  └── logs/                   # Логи системы
  ```

### Исправлено (дополнительно)
- **Обработка данных Vision API**
  - Исправлена структура данных от Claude 3.5 Sonnet через OpenRouter
  - Добавлена санитизация bbox координат для Handlebars шаблонов
  - Улучшена обработка элементов без properties
  - Добавлена проверка на NaN и Infinity значения

- **Конфигурация проекта**
  - Обновлен .gitignore с Node.js правилами
  - Добавлены специфичные папки проекта (logs/, output/, incoming/, processed/)
  - Исправлена структура package.json файлов

- **Дебаг и мониторинг**
  - Добавлено подробное логирование на всех этапах обработки
  - Улучшена диагностика ошибок Handlebars шаблонов
  - Добавлен дебаг режим для понимания структуры данных

### Известные проблемы
- Handlebars шаблон генерирует ошибку парсинга при определенных данных
- Требуется дополнительная настройка для стабильной работы с различными типами UI элементов
- Некоторые модели OpenRouter могут быть недоступны в определенных регионах

### Планы на будущее
- Исправление ошибок Handlebars шаблонов
- Добавление поддержки дополнительных UI библиотек
- Улучшение точности анализа изображений
- Добавление тестов
- Оптимизация производительности
- Создание TODO списка для отслеживания задач

### Новая архитектура (в разработке)
- **Гибридный подход к генерации компонентов**
  - Базовое сопоставление AI анализа с React компонентами
  - Итеративная оптимизация ключевых параметров
  - Визуальная валидация результатов
- **Улучшенная обработка ошибок**
  - Fallback компоненты с данными от AI
  - Детальное логирование процесса генерации
  - Валидация структуры данных
- **Конфигурируемые промпты**
  - Вынесение промптов в отдельный конфиг
  - Возможность настройки без изменения кода
  - Fallback промпты для критических ошибок

---

## [Unreleased]

### Планируется
- Исправление ошибок генерации компонентов
- Добавление поддержки Material-UI компонентов
- Улучшение UI/UX веб-интерфейса
- Добавление экспорта в различные форматы
- Интеграция с популярными IDE

---

## Поддержка

Для получения помощи или сообщения об ошибках:
- Создайте issue в репозитории
- Проверьте логи в папке `logs/`
- Убедитесь, что все зависимости установлены
- Проверьте конфигурацию API ключей

## Лицензия

Проект распространяется под лицензией ISC. См. файл [LICENSE](LICENSE) для подробностей.
